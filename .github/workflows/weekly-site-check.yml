# name: Weekly Site Check

# permissions:
#   contents: write
# on:
#   schedule:
#     # every Sunday at 00:00 UTC
#     - cron: "0 0 * * 0"
#   workflow_dispatch: {}

# jobs:
#   check-sites:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Checkout repository
#         uses: actions/checkout@v4
#         with:
#           fetch-depth: 0
#           persist-credentials: true

#       - name: Set up Node.js
#         uses: actions/setup-node@v4
#         with:
#           node-version: "18"

#       - name: Install Playwright
#         run: |
#           npm init -y
#           npm i -D playwright yaml
#           npx playwright install --with-deps

#       - name: Run Playwright site check
#         run: |
#           node ./scripts/check_links_playwright.mjs
#         env:
#           CONCURRENCY: 8

#       - name: Upload unreachable sites JSON
#         uses: actions/upload-artifact@v4
#         with:
#           name: unreachable-sites
#           path: unreachable-sites.json
#           if-no-files-found: ignore

#       - name: Commit unreachable file
#         if: always()
#         run: |
#           git config user.name "github-actions[bot]"
#           git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
#           git add unreachable-sites.json || true
#           if git diff --staged --quiet; then
#             echo "no changes to commit"
#           else
#             git commit -m "ci: update unreachable-sites.json" || echo "commit failed"
#             git push origin HEAD:main || echo "push failed"
#           fi
